# 以太网例程使用注意事项

版本：1.0

## 1、硬件驱动使用

以太网工程中的 NetLib 文件夹包含了不同硬件接口的驱动文件和协议栈库文件等，如下图 a 所示。MAC_RAW 例程中 ETH_Driver 文件夹下有不同硬件接口的驱动文件，没有库相关文件，如下图 b所示。默认情况下使用的是MCU内置的10M PHY驱动。

![](images/6113807707df410695ee15382aa10d7cdbe941b45cdd7c3e57b830750ef7dc44.jpg)

当需要切换为不同的驱动时，要进行以下步骤：

（1）、将 10M PHY 驱动排除编译。鼠标右击需要排除编译的文件，调出设置菜单，点击“Include/Exclude From Build”，即可将该文件排除编译。

MounRiver 1.x 版本：

![](images/eb55042b3ace46b8643fdeb3a990756fe90f42665f8cc99d2d4a5c4c53f2f03a.jpg)

MounRiver 2.x 版本：

![](images/86223b48a43d39197d22fe18fbf4a0cf5a6795bc37adc1d53eb58c9ed367e6a3.jpg)

（2）、与上一步一样，根据硬件需要将对应的驱动参与编译即可。  
（3）、如果芯片是 CH32V317，且使用 WCH-Link 工具下载时，要根据下图将 MCU 的型号切换CH32V317。

MounRiver 1.x 版本：

![](images/1df885ddaa539b26d328706aafd66d9c9534eb6d5c17a000ac36bf30ff015aa4.jpg)

### MounRiver 2.x 版本：

![](images/f52f8b7aaba03e0feb9dcb07ad65eefb6045dd128fc29c72775d72ce05a31845.jpg)

#### 根据使用的硬件接口配置结果如下图所示：

### （1）、使用RMII接口驱动：

![](images/f2d4e7e79a7db30c328ca99a86b716178e9ef0fa5d0bf511affd7424609b777b.jpg)

#### NetLib

eth driver RMIl.c   
eth_driver.h   
wchnet.h   
  
  
  
  
  
libwchnet.a

a.NetLib 文件夹

![](images/2ab94abdc5ee281b411d755e9a889145db24581c21d7df87f0d60dd787cb59e0.jpg)

#### ETH Driver

@ eth_driver_RMI1.c   
eth_driver.h

b.ETH_Driver 文件夹

### （2）、使用 MII 接口驱动：

![](images/6325482c9b13ad7027a9605e3e2a406a76a064b0399ba9b5704a69f13c7910dd.jpg)

#### NetLib

eth driver Mll.c   
eth driver.h   
wchnet.h   
  
  
  
  
  
libwchnet.a

a. NetLib 文件夹

![](images/a0600436dfd01a183bc9b25e4cf169773f1fef633080b5f8ff861b2b34d8fc34.jpg)

#### ETH Driver

eth_driver_MIl.c   
eth_driver.h   
  
  
  
  
b. ETH_Driver 文件夹

### （3）、使用 RGMII 接口驱动：

![](images/198358f21c296e48f1a5315cd7c573d8b523762df40d66623d7613c948ef75ea.jpg)

#### NetLib

eth_driver_RGMIl.c   
eth_driver.h   
wchnet.h   
  
  
  
  
  
libwchnet.a

a. NetLib 文件夹

![](images/8149852df374654bfff4b1cfff03dfd48bb59bb56c2abb4fa2a8f7ea01902aee.jpg)

#### ETH_Driver

eth_driver_RGMIl.c   
eth_driver.h   
  
  
  
  
b. ETH_Driver 文件夹

### （4）、使用 CH32V317 驱动：

![](images/c96b8cd0a464a236eb5ccc65295972e8de325c4688aa277e929ac8dbf9429ccf.jpg)

#### NetLib

eth_driver_CH32V317.c   
eth driver.h   
wchnet.h   
  
  
  
  
  
libwchnet.a

a. NetLib 文件夹

![](images/5559339b066599b37e215002bd9a6f395a061591c71be48b8a82fe698b46fc5a.jpg)

#### ETH_Driver

D eth driver CH32V317.c   
eth_driver.h

b. ETH_Driver 文件夹

## 2、硬件浮点库使用

当工程中开启硬件浮点功能，需要将以太网浮点库添加至工程中，需要进行下列两步：

### （1）、开启硬件浮点功能

鼠标右击需要开启硬件浮点的工程文件名，调出设置菜单，点“Properties”。

![](images/558f4feb3427d6028ff3d58f89427d63f03640c79b5f1ae9ae30d72a0f0e7649.jpg)

进行如下图配置。

MounRiver 1.x 版本：

![](images/86d2fc4cb87cab6d5f1150c82b9661e5df3039602865a1e7d585eb8eff8ca5e1.jpg)

MounRiver 2.x 版本：

![](images/01f34afa890c8840a747fbc94a47acaf7dd3d0ac32c48654fdd92106523d45b5.jpg)

（2）、将以太网浮点库参与编译

首先，与选择不同驱动参与编译的操作方法类似，将浮点库参与编译。然后，与上一步一样操作，调用出“Properties”后，按照下图配置，将硬件浮点库添加到工程中。

#### MounRiver 1.x 版本：

![](images/571ee926b37670289284a518ef17f9f86d3361bc0d5a7ce448ac1feea6a0736a.jpg)

#### MounRiver 2.x 版本：

![](images/1f2229880faebe4ce6cd05df06a4dfc8d43aa73ac6220d89217bd329077c35cd.jpg)

注：从EVT文件夹中有本文档开始，非浮点库也支持工程开启硬件浮点功能，也就是可以省略上述步骤（2）。